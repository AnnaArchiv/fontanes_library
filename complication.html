<!doctype html>
<html lang="de">

<head>
    <meta charset="utf-8">
    <title>Fontanes Handbibliothek</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Eine explorative Visualisierung von Lese- und Schriftspuren in Theodor Fontanes Handbibliothek mit der Datenerschließung des Theodor Fontane Archivs."/>
    <meta property="og:url"                content="https//uclab.fh-potsdam.de/ff" />
    <meta property="og:type"               content="website" />
    <meta property="og:title"              content="Theodor Fontanes Handbiblitothek"/>
    <meta property="og:description"        content="Eine explorative Visualisierung von Lese- und Schriftspuren in Theodor Fontanes Handbibliothek mit der Datenerschließung des Theodor Fontane Archivs." />
    <!-- <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" /> -->
    <script src="js/d3.v5.min.js"></script>
    <script src="js/jquery.min.js"></script>
    <script src="js/select2.min.js"></script>
    <link rel="stylesheet" type="text/css" href="css/select2.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Reenie+Beanie|Stardos+Stencil" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Homemade+Apple" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Volkhov" rel="stylesheet">




    <style type="text/css">


        html,
        body {
             font-family: 'Roboto', sans-serif;

            background-color: rgb(23, 22, 20);
            margin: 0;
            color: #f7e5d7;
            overflow-y: scroll;
            overflow-x: scroll;
            width: 100%;
            height: 5000px;

          }

        /* ::-webkit-scrollbar {
            display: none;
        } */


        h1 {
            margin-left: 0px;
            margin-top: 17px;
            margin-bottom: 0;
            font-weight: 500;
            varter-spacing: 2px;
            font-size: 28px;
             text-transform: uppercase;
                /* font-family: 'Volkhov', serif; */
        }

        #legend {
            fill: #f7e5d7;
            text-transform: uppercase;
            margin-left: 0px;
            margin-top: 10px;
            font-weight: 400;
            font-size: 12px;
            width: 1000px;
            height: 60px;
            /*  varter-spacing: 0.5px */
            /* display: none; */
        }


        .plusminus{
          font-size: 15px;
          margin-right: 0px;
        }

        .stempel{
          font-family: 'Stardos Stencil';
          font-size: 12px;
        }

        .handschrift{
          font-family: 'Roboto';
          font-size: 12px;
          font-weight: 300;
          /* font-style: italic; */
        }


        .eigentumsangaben {
          fill: #878787;
          color: #878787;
        }

        .markierungen {
          fill: #58b0f7;
          color: #58b0f7;
        }

        .marginalien {
          fill: #f73f26;
          color: #f73f26;
        }

        span {
            margin-right: 10px;
        }




        #header {
            z-index: 200;
            position: fixed;
            left: 125px;
            top: 0px;
            width: 100%;
        }


        #scrollnavi {
            z-index: 100;
            position: fixed;
            background-color: #474747;
            border-right: 1px;
            height: 100%;
            width: 80px;
            left: 0;
            top: 0px;
            box-shadow: 2px 0px 5px black;
            padding-top: 0px;
        }

        #scrollnavi p {
            z-index: 100;
            font-size: 11px;
            margin-left: 5px;
            margin-top: 150px;
            margin-bottom: 150px;
            color: white;
            font-weight: 300;
            varter-spacing: 2px;
            text-transform: uppercase;
        }

        #scrollnavi svg {
            z-index: 100;
            position: fixed;
            width: 80px;
            height: 100%;
        }

        #headerIcons {

            z-index: 100;
            float: right;
            padding-right: 100px;
        }

        .search-container {
            float: right;
        }

        #headerIcons input[type=text] {
            padding: 4px;
            width: 160px;
            margin-top: 20px;
            font-size: 12px;
            border-width: 1px;
            border-color: lightgrey;
            border-style: solid;
        }

        .search-container button {
            float: right;
            padding: 4px 6px;
            margin-top: 20px;
            background: white;
            font-size: 12px;
            color: grey;
            border-width: 1px;
            border-color: lightgrey;
            border-style: solid;
            border-left: none;
            cursor: pointer;
        }

        .search-container button:hover {
            background: #ccc;
        }

        .headericons {
            margin-top: 20px;
            margin-right: 0px;
            margin-left: 10px;
            float: right;
            width: 26px;
            height: 26px;
              font-family: 'Roboto', sans-serif!important;
        }



        /*
        * === SEARCH BOX===
        */


        .searchiconbg {
        background-color: lightgrey;
          height: 24px;
          margin-top: 0px;
          margin-left: 13px;
        }

        #search-icon {
          position: relative;
          margin-top: 3px;
        padding-left: 5px;
          padding-right:5px;
          color:#888888;

        }

        .search {
          position: relative;
          width: 300px;
          font-size: 12px;
          margin-left: 0px;
          margin-top:20px;
          border:0;
        }



        /*
        * === SEARCH BOX===
        */

        #scroller {
            overflow: scroll;
            height: 100%;
            width: 120px;
            left: 0;
            top: 0px;
        }

        #svg {
          position: fixed;
            margin-left: 83px;
            left: 0;
            margin-top: 150px;
        }

        #svgFront {
            overflow-x: hidden;
            position: fixed;
            margin-left: 83px;
            left: 0;
            margin-top: 150px;
            pointer-events: none;
        }

        #svgFrontTitles {
            overflow-x: hidden;
            position: fixed;
            margin-left: 83px;
            left: 0;
            margin-top: 150px;
            pointer-events: none;
            display:  inline;
        }

        canvas {
            position: fixed;
            margin-left: 83px;
            left: 0;
            margin-top: 270px;
            width: 100%;
            height: 6500px;
            pointer-events: none;
        }


        #container {
            top: 0px;
            position: fixed;
        }

        .anstreichung {
          color: #018DC9;
          fill: #018DC9;
          cursor: pointer;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;
        }

        .anstreichung.eingefaltet {
          fill: #58b0f7;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;
        }

        .unterstreichung {
          color: #415aff;
          fill: #415aff;
          cursor: pointer;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;
        }

        .unterstreichung.eingefaltet {
          fill: #58b0f7;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;

        }

        .durchstreichung {
          color: #4020d0;
          fill: #4020d0;
          cursor: pointer;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;
        }

        .durchstreichung.eingefaltet {
          fill: #58b0f7;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;
        }

        .sonstigeMarkierung {
          color: #29D1E2;
          fill: #29D1E2;
          cursor: pointer;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;
        }

        .sonstigeMarkierung.eingefaltet {
          fill: #58b0f7;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;
        }

        .anderes {
          color: #f284c0;
          fill: #f284c0;
          cursor: pointer;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;
        }

        .anderes.eingefaltet {
          fill: #f284c0;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;
        }

        .zusatzMaterial {
          color: rgb(210, 164, 0);
          fill: rgb(210, 164, 0);
          cursor: pointer;

        }

        .platzhalter {
          fill: #f7e5d7;
          cursor: pointer;
          stroke-width: 1px;
          stroke: #f7e5d7;

        }


        .provenienz {
          color: #494747;
          fill: #494747;
          cursor: pointer;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;
        }

        .provenienz.eingefaltet {
          fill: #878787;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;

        }

        .provenienzstempel {
          color: #828282;
          fill: #828282;
          cursor: pointer;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;

        }

        .provenienzstempel.eingefaltet {
          fill: #878787;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;
        }

        .bewertung {
          color: #dd0000;
          fill: #dd0000;
          cursor: pointer;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;
        }

        .bewertung.eingefaltet {
          fill: #f73f26;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;

        }

        .kommentar {
          color: #FF8A5D;
          fill: #FF8A5D;
          cursor: pointer;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;
        }

        .kommentar.eingefaltet {
          fill: #f73f26;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;

        }

        .textkorrektur {
          color: #8D084E;
          fill: #8D084E;
          cursor: pointer;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;
        }

        .textkorrektur.eingefaltet {
          fill: #f73f26;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;

        }

        .uebersetzung {
          color: #d93168;
          fill: #d93168;
          cursor: pointer;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;
        }

        .uebersetzung.eingefaltet {
          fill: #f73f26;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;

        }

        .variante {
          color: #FD9698;
          fill: #FD9698;
          cursor: pointer;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;
        }

        .variante.eingefaltet {
          fill: #f73f26;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;
        }

        .leer {
          padding-left: 5px;
          padding-right: 5px;
          color: #ffffff;
          fill: #ffffff;
          background-color: rgb(206, 193, 184);
        }


        .filtered {
          fill: white !important;
          -webkit-transition: fill 0.5s linear;
          -moz-transition: fill 0.5s linear;
          -o-transition: fill 0.5s linear;
          transition: fill 0.5s linear;
        }

        .authorLabel {
            font-size: 11px;
            font-weight: 400;
        }

        .BuchTitelLabel {
            font-size: 12px;
        }

        .detailinfo {
            font-size: 12px;
            font-weight: bold;
        }

        .detail_titel {
            font-weight: bold;
        }



        .scroll-wrapper {
            position: relative;
            height: 100%;
            padding-top: 0px;
        }





        .navigationLabels {
            font-size: 11px;
            text-transform: uppercase;
        }

        #iconshare{
          margin-right: 100px;
        }

#complicationsvg{
  position: fixed;
    margin-left: 83px;
    left: 0;
    margin-top: 150px;
}

.pietooltip{
  background-color: rgba(71, 71, 71, 0.8);
  color: white;
  position: absolute;
  z-index: 300;
  padding:0px;
  width: 600px;
  display: none;
}

.tooltipTitle{
  text-align: left;
  margin: 0;
  font-weight: bold;
}

.tooltiptypes{
  margin: 0;
  font-weight: 300;
  font-size: 13px;
}

.tooltipImage{
  padding: 0px;
  margin: 0px;
  vertical-align: top;
  text-align: right;
  width: 245px;
  padding-right: 5px;
}

.coverimagesSolo{
  width: 250px;
  vertical-align: top;
  text-align: left;
  margin: 0px;
}


.coverimagesMulti{
  width: 60px;
  vertical-align: top;
  text-align: left;
  margin: 0px;
}

.tg td{
  font-size: 13px;
  vertical-align: top;
}

.tt-data{
  font-weight: bold;
}


    </style>
</head>

<body>
  <div id="header">
      <div id="headerIcons">
          <img alt="share" id="iconshare" src="icons/icon-share.svg" class="headericons">
          <img alt="help" src="icons/icon-help.svg" class="headericons">
          <img alt="info" src="icons/icon-info.svg" class="headericons">


          <div class="search-container">
            <div id="search"></div>


          </div>

      </div>

      <h1>Fontanes Handbibliothek</h1>
      <svg id="legend"></svg>

  </div>
  <svg id="complicationsvg"></svg>


    <div id="scrollnavi">
        <svg id="scrollSvg"></svg>
    </div>







    <div id="container">


    </div>




    </div>

    <div class="pietooltip">
      <table class="tg">
  <tr>
    <th class="tooltipImage" rowspan="14">
    </th>
    <th class="tt-title tooltipTitle" colspan="2"></th>
  </tr>
  <tr>
    <td class="tooltiptypes">Verfasser:</td>
    <td class="tt-verfasser tt-data"></td>
  </tr>
  <tr>
    <td class="tooltiptypes">Herausgeber:</td>
    <td class="tt-herausgeber tt-data"></td>
  </tr>
  <tr>
    <td class="tooltiptypes">Verlag:</td>
    <td class="tt-verlag tt-data"></td>
  </tr>
  <tr>
    <td class="tooltiptypes">Genre:</td>
    <td class="tt-genre tt-data"></td>
  </tr>
  <tr>
    <td class="tooltiptypes">Datierung:</td>
    <td class="tt-datierung tt-data"></td>
  </tr>
  <tr>
    <td class="tooltiptypes">Ort:</td>
    <td class="tt-ort tt-data"></td>
  </tr>
  <tr>
    <td class="tooltiptypes">Marginalien-Schreibhände:</td>
    <td class="tt-schreibhand tt-data"></td>
  </tr>
  <tr>
    <td class="tooltiptypes">Seitenzahl:</td>
    <td class="tt-seitenzahl tt-data"></td>
  </tr>
  <tr class="eigentumsangaben">
    <td class="tooltiptypes">Provenienzangaben:</td>
    <td class="tt-provenienz tt-data"></td>
  </tr>
  <tr class="marginalien">
    <td class="tooltiptypes">Marginalien:</td>
    <td class="tt-marginalien tt-data"></td>
  </tr>
  <tr class="markierungen">
    <td class="tooltiptypes">Markierungen:</td>
    <td class="tt-markierungen tt-data"></td>
  </tr>
  <tr class="zusatzMaterial">
    <td class="tooltiptypes">Zusätzliches Material:</td>
    <td class="tt-zusatzMaterial tt-data"></td>
  </tr>
  <tr class="anderes">
    <td class="tooltiptypes">Anderes:</td>
    <td class="tt-anderes tt-data"></td>
  </tr>
</table>
    </div>

    <script>

var pietooltip = d3.select(".pietooltip")

    // pietooltip
    // .append("p").attr("class","tooltipTitle")
    //
    // pietooltip
    // .append("p").attr("class","tooltiptypes")
    // .text("Verfasser:")
    //
    // pietooltip
    // .append("p").attr("class","tooltiptypes")
    // .text("Herausgeber:")
    //
    // pietooltip
    // .append("p").attr("class","tooltiptypes")
    // .text("Verlag:")
    //
    // pietooltip
    // .append("p").attr("class","tooltiptypes")
    // .text("Genre:")
    //
    // pietooltip
    // .append("p").attr("class","tooltiptypes")
    // .text("Datierung:")
    //
    // pietooltip
    // .append("p").attr("class","tooltiptypes")
    // .text("Ort:")
    //
    // pietooltip
    // .append("br")
    //
    // pietooltip
    // .append("p").attr("class","tooltiptypes")
    // .text("Seitenzahl:")
    //
    // pietooltip
    // .append("p").attr("class","tooltiptypes")
    // .classed("eigentumsangaben", true)
    // .text("Provenienzangaben:")
    //
    // pietooltip
    // .append("p").attr("class","tooltiptypes")
    // .classed("marginalien", true)
    // .text("Marginalien:")
    //
    // pietooltip
    // .append("p").attr("class","tooltiptypes")
    // .classed("markierungen", true)
    // .text("Markierungen:")
    //
    // pietooltip
    // .append("p").attr("class","tooltiptypes")
    // .classed("zusatzMaterial", true)
    // .text("Zusätzliches Material:")
    //
    // pietooltip
    // .append("p").attr("class","tooltiptypes")
    // .classed("anderes", true)
    // .text("Anderes:")

    Promise.all([
      d3.csv("data/complication.csv"),
      d3.csv("data/korpus.csv"),
    ])
    .then(([complicationData, korpus]) =>  {

      var transitions = false
      var scroller = d3.select('body')

      window.onscroll = function(){//console.log(Math.max(window.pageYOffset, document.documentElement.scrollTop, document.body.scrollTop))
    //    console.log(scroller.node().scrollTop)
    //    console.log($(window).scrollTop())
        var scrollTop2 = Math.max(window.pageYOffset, document.documentElement.scrollTop, document.body.scrollTop)

                        newScrollTop = scrollTop2
                  //     console.log(newScrollTop)

                        ////////////////////scrollnavi/
                        ////////////////////////////////////////

                        // var scrollCircleScale = d3.scaleLinear()
                        //     .domain([-4990, 0, 2600])
                        //     .range([firstScrollIcon, secondScrollIcon, thirdScrollIcon-5])
                        //     .clamp(true)

                        // d3.selectAll(".scrollCircleFollower")
                        //     .attr("cy", scrollCircleScale(newScrollTop))


      }

      var scrollTop = 0
      var newScrollTop = scroller.node().scrollTop// - 5050 - 301
    //console.log(scroller.node().scrollTop)

      scroller
          .on("scroll", function() {



    var scrollTop2 = Math.max(window.pageYOffset, document.documentElement.scrollTop, document.body.scrollTop)


              newScrollTop = scrollTop2




              ////////////////////scrollnavi/
              ////////////////////////////////////////



              // d3.selectAll(".scrollCircleFollower")
              //     .attr("cy", scrollCircleScale(newScrollTop))


              ////////////////////scrollnaviEnde
              ////////////////////////////////////////
          })
compScrollFunction()

          function animate() {

              if (transitions == true || scrollTop !== newScrollTop) {
                  scrollTop = newScrollTop
                  compScrollFunction()

              }
              window.requestAnimationFrame(animate);
          }
          window.requestAnimationFrame(animate);














                      var filter = null
                      var eigentumsangabenEntfaltet = false
                      var markierungenEntfaltet = false
                      var marginalienEntfaltet = false

                      var legend = d3.select("#legend")

                      legend.append("text")
                      .text("Schriftspur-Typ")
                      .style("font-weight", "bold")
                      .style("varter-spacing", "1px")
                      .attr("y", 14)
                      .attr("x", 0)

                      var eigentumsangaben = legend.append("g")
                          .attr("class", "eigentumsangaben")
                          .style("cursor", "pointer")
                          .attr("transform", "translate(135,0)")

                          eigentumsangaben.append("text")
                          .attr("y", 14)

                      var zusatzMaterial = legend.append("g")
                          .attr("class", "zusatzMaterial")
                          .style("cursor", "pointer")
                          .attr("transform", "translate(555,0)")



                      var anderes = legend.append("g")
                              .attr("class", "anderes")
                              .style("cursor", "pointer")
                              .attr("transform", "translate(725,0)")

                      var markierungen = legend.append("g")
                          .attr("class", "markierungen")
                          .style("cursor", "pointer")
                          .attr("transform", "translate(300,0)")

                          markierungen.append("text")
                          .attr("y", 14)

                      var marginalien = legend.append("g")
                          .attr("class", "marginalien")
                          .style("cursor", "pointer")
                          .attr("transform", "translate(435,0)")

                          marginalien.append("text")
                          .attr("y", 14)


                      // var marginalienVerfasser = legend.append("g")
                      //     .attr("class", "marginalienVerfasser")
                      //     .style("cursor", "pointer")
                      //
                      //     marginalienVerfasser.append("text")
                      //     .text("Marginalien Schreibhand")
                      //     .style("font-weight", "bold")
                      //     .style("cursor", "auto")
                      //     .style("varter-spacing", "1px")
                      //     .attr("y", 14)
                      //     .attr("x", 0)
                      //
                      //   //  var SchreibhandFilter = null
                      //
                      //     marginalienVerfasser.append("text")
                      //     .text("Theodor Fontane")
                      //     .attr("y", 14)
                      //     .attr("x", 200)
                      //     .on("click", function(){
                      //       if(filter != "Fontane"){
                      //         filter = "Fontane"
                      //         filterInteraction()
                      //       }else{
                      //         filter = null
                      //         filterInteraction()
                      //       }
                      //     })
                      //
                      //     marginalienVerfasser.append("text")
                      //     .text("Fontanes Familie")
                      //     .attr("y", 14)
                      //     .attr("x", 330)
                      //     .on("click", function(){
                      //       if(filter != "Familie"){
                      //         filter = "Familie"
                      //         filterInteraction()
                      //       }else{
                      //         filter = null
                      //         filterInteraction()
                      //       }
                      //     })
                      //
                      //     marginalienVerfasser.append("text")
                      //     .text("Andere / Unbekannt")
                      //     .attr("y", 14)
                      //     .attr("x", 460)
                      //     .on("click", function(){
                      //       if(filter != "Unbekannt"){
                      //         filter = "Unbekannt"
                      //         filterInteraction()
                      //       }else{
                      //         filter = null
                      //         filterInteraction()
                      //       }
                      //     })

                          ////////////////Provenienz-Filter Start
                          ///////////////////////////////////////////////


                          eigentumsangaben.select("text").append("tspan")
                              .text("Provenienzangaben")
                              .attr("class", "EigentumsangabenFilter")
                              .on("click", function() {
                                if (filter != "eigentumsangaben"){
                                  filter = "eigentumsangaben"
                                  eigentumsangabenEntfaltet = true


                                  farbausfaltungProvenienz()
                                  filterInteraction()
                                  eigentumsangaben.selectAll(".EigentumsangabenPlus").text(" ⊖")
                                  markierungen.selectAll(".MarkierungenPlus").text(" ⊕")
                                  marginalien.selectAll(".MarginalienPlus").text(" ⊕")
                                  eigentumsangaben.selectAll("text").style("font-weight", "bolder").style("opacity", 1)
                                  zusatzMaterial.selectAll("text").style("font-weight", "400").style("opacity",.6)
                                  anderes.selectAll("text").style("font-weight", "400").style("opacity",.6)
                                  marginalien.selectAll("text").style("font-weight", "400").style("opacity", .6)
                                  markierungen.selectAll("text").style("font-weight", "400").style("opacity", .6)

                                  eigentumsangabendetail.transition().duration(800).attr("transform", "scale(1,1)").style("opacity", 1)
                                  markierungendetail.transition().duration(800).attr("transform", "scale(0,1)").style("opacity", 1)
                                  marginaliendetail.transition().duration(800).attr("transform", "scale(0,1)").style("opacity", 1)

                                }
                                else {
                                  filter = null
                                  eigentumsangabenEntfaltet = false

                                  farbeinfaltungProvenienz()
                                  filterInteraction()
                                  eigentumsangaben.selectAll(".EigentumsangabenPlus").text(" ⊕")
                                  zusatzMaterial.selectAll("text").style("font-weight", "400").style("opacity", 1)
                                  marginalien.selectAll("text").style("font-weight", "400").style("opacity", 1)
                                  anderes.selectAll("text").style("font-weight", "400").style("opacity", 1)
                                  markierungen.selectAll("text").style("font-weight", "400").style("opacity", 1)
                                  eigentumsangaben.selectAll("text").style("font-weight", "400").style("opacity", 1)
                                  eigentumsangabendetail.transition().duration(800).attr("transform", "scale(0,1)").style("opacity", 0)
                                  }

                              })

                          eigentumsangaben.select("text").append("tspan")
                              .text(" ⊕")
                              .attr("class", "EigentumsangabenPlus")
                              .style("font-size", 17 + "px")
                              // .on("click", function() {
                              //   if (eigentumsangabenEntfaltet == false){
                              //     eigentumsangabenEntfaltet = true
                              //
                              //     farbausfaltungProvenienz()
                              //     eigentumsangaben.selectAll(".EigentumsangabenPlus").text(" ⊖")
                              //     eigentumsangaben.selectAll("text").style("font-weight", "bolder")
                              //     eigentumsangabendetail.transition().duration(800).attr("transform", "scale(1,1)").style("opacity", 1)
                              //   }
                              //   else {
                              //     eigentumsangabenEntfaltet = false
                              //
                              //     farbeinfaltungProvenienz()
                              //     eigentumsangaben.selectAll(".EigentumsangabenPlus").text(" ⊕")
                              //     eigentumsangaben.selectAll("text").style("font-weight", "500")
                              //     eigentumsangabendetail.transition().duration(800).attr("transform", "scale(0,1)").style("opacity", 0)
                              //     }
                              // })



                                          var eigentumsangabendetail = eigentumsangaben.append("g").attr("class", "detail").attr("transform", "scale(0,1)").style("opacity", 0)

                                          eigentumsangabendetail.append("text")
                                              .text("Schriftl. Provenienzangaben")
                                              .attr("y", 28)
                                              .attr("x", 0)
                                              .attr("class", "provenienz")
                                              .on("click", function(){
                                                if(filter != "provenienz"){
                                                  filter = "provenienz"
                                                  filterInteraction()
                                                }else{
                                                  filter = null
                                                  filterInteraction()
                                                }
                                              })


                                          eigentumsangabendetail.append("text")
                                              .text("Provenienz-Stempel")
                                              .attr("y", 28)
                                              .attr("x", 210)
                                              .attr("class", "provenienzstempel")
                                              .on("click", function(){
                                                if(filter != "provenienzstempel"){
                                                  filter = "provenienzstempel"
                                                  filterInteraction()
                                                }else{
                                                  filter = null
                                                  filterInteraction()
                                                }
                                              })


          ////////////////Provenienz-Filter Ende
          ///////////////////////////////////////////////


          ////////////////Markierung-Filter Start
          ///////////////////////////////////////////////

                      markierungen.select("text").append("tspan")
                          .text("Markierungen")
                          .attr("class", "MarkierungFilter")
                          .on("click", function() {
                            if (filter != "markierungen"){
                              filter = "markierungen"
                              markierungenEntfaltet = true

                              farbausfaltungMarkierung()
                              filterInteraction()
                              eigentumsangaben.selectAll(".EigentumsangabenPlus").text(" ⊕")
                              markierungen.selectAll(".MarkierungenPlus").text(" ⊖")
                              marginalien.selectAll(".MarginalienPlus").text(" ⊕")
                              markierungen.selectAll("text").style("font-weight", "bolder").style("opacity", 1)
                              zusatzMaterial.selectAll("text").style("font-weight", "400").style("opacity", .6)
                              anderes.selectAll("text").style("font-weight", "400").style("opacity", .6)
                              marginalien.selectAll("text").style("font-weight", "400").style("opacity", .6)
                              eigentumsangaben.selectAll("text").style("font-weight", "400").style("opacity", .6)

                              eigentumsangabendetail.transition().duration(800).attr("transform", "scale(0,1)").style("opacity", 1)
                              markierungendetail.transition().duration(800).attr("transform", "scale(1,1)").style("opacity", 1)
                              marginaliendetail.transition().duration(800).attr("transform", "scale(0,1)").style("opacity", 1)


                            }
                            else {
                              filter = null
                              markierungenEntfaltet = false

                              farbeinfaltungMarkierung()
                              filterInteraction()
                              markierungen.selectAll(".MarkierungenPlus").text(" ⊕")
                              zusatzMaterial.selectAll("text").style("font-weight", "400").style("opacity", 1)
                              marginalien.selectAll("text").style("font-weight", "400").style("opacity", 1)
                              markierungen.selectAll("text").style("font-weight", "400").style("opacity", 1)
                              eigentumsangaben.selectAll("text").style("font-weight", "400").style("opacity", 1)
                              anderes.selectAll("text").style("font-weight", "400").style("opacity", 1)
                              markierungendetail.transition().duration(800).attr("transform", "scale(0,1)").style("opacity", 0)
                              }
                          })




                      markierungen.select("text").append("tspan")
                          .text(" ⊕")
                          .attr("class", "MarkierungenPlus")
                          .style("font-size", 17 + "px")
                          // .on("click", function() {
                          //   if (markierungenEntfaltet == false){
                          //     markierungenEntfaltet = true
                          //
                          //     farbausfaltungMarkierung()
                          //     markierungen.selectAll(".MarkierungenPlus").text(" ⊖")
                          //     markierungen.selectAll("text").style("font-weight", "bolder")
                          //     markierungendetail.transition().duration(800).attr("transform", "scale(1,1)").style("opacity", 1)
                          //   }
                          //   else {
                          //   markierungenEntfaltet = false
                          //
                          //     farbeinfaltungMarkierung()
                          //     markierungen.selectAll(".MarkierungenPlus").text(" ⊕")
                          //     markierungen.selectAll("text").style("font-weight", "500")
                          //     markierungendetail.transition().duration(800).attr("transform", "scale(0,1)").style("opacity", 0)
                          //     }
                          // })

                      var markierungendetail = markierungen.append("g").attr("class", "detail").attr("transform", "scale(0,1)").style("opacity", 0)

                      markierungendetail.append("text")
                          .text("Anstreichung")
                          .attr("y", 28)
                          .attr("x", 0)
                          .attr("class", "anstreichung")
                          .on("click", function(){
                            if(filter != "anstreichung"){
                              filter = "anstreichung"
                              filterInteraction()
                            }else{
                              filter = null
                              filterInteraction()
                            }
                          })

                      markierungendetail.append("text")
                          .text("Unterstreichung")
                          .attr("y", 28)
                          .attr("x", 110)
                          .attr("class", "unterstreichung")
                          .on("click", function(){
                            if(filter != "unterstreichung"){
                              filter = "unterstreichung"
                              filterInteraction()
                            }else{
                              filter = null
                              filterInteraction()
                            }
                          })

                      markierungendetail.append("text")
                          .text("Durchstreichung")
                          .attr("y", 28)
                          .attr("x", 240)
                          .attr("class", "durchstreichung")
                          .on("click", function(){
                            if(filter != "durchstreichung"){
                              filter = "durchstreichung"
                              filterInteraction()
                            }else{
                              filter = null
                              filterInteraction()
                            }
                          })

                      markierungendetail.append("text")
                          .text("Sonstige Markierung")
                          .attr("y", 28)
                          .attr("x", 370)
                          .attr("class", "sonstigeMarkierung")
                          .on("click", function(){
                            if(filter != "sonstigeMarkierung"){
                              filter = "sonstigeMarkierung"
                              filterInteraction()
                            }else{
                              filter = null
                              filterInteraction()
                            }
                          })

                      // markierungendetail.append("text")
                      //     .text("Anderes")
                      //     .attr("y", 28)
                      //     .attr("x", 530)
                      //     .attr("class", "anderes")
                      //     .on("click", function(){
                      //       if(filter != "anderes"){
                      //         filter = "anderes"
                      //         filterInteraction()
                      //       }else{
                      //         filter = null
                      //         filterInteraction()
                      //       }
                      //     })



                          ////////////////Markierung-Filter Ende
                          ///////////////////////////////////////////////

                          ////////////////Marginalien-Filter Start
                          ///////////////////////////////////////////////

                                      marginalien.select("text").append("tspan")
                                          .text("Marginalien")
                                          .attr("class", "MarginalienFilter")
                                          .on("click", function() {
                                            if (filter != "marginalien"){
                                              filter = "marginalien"
                                              marginalienEntfaltet = true

                                              farbausfaltungMarginalien()
                                              filterInteraction()
                                              marginalien.selectAll(".MarginalienPlus").text(" ⊖")
                                              marginalien.selectAll("text").style("font-weight", "bolder")
                                              marginaliendetail.transition().duration(800).attr("transform", "scale(1,1)").style("opacity", 1)

                                              eigentumsangaben.selectAll(".EigentumsangabenPlus").text(" ⊕")
                                              markierungen.selectAll(".MarkierungenPlus").text(" ⊕")
                                              marginalien.selectAll(".MarginalienPlus").text(" ⊖")
                                              marginalien.selectAll("text").style("font-weight", "bolder").style("opacity", 1)
                                              zusatzMaterial.selectAll("text").style("font-weight", "400").style("opacity", .6)
                                              anderes.selectAll("text").style("font-weight", "400").style("opacity", .6)
                                              markierungen.selectAll("text").style("font-weight", "400").style("opacity", .6)
                                              eigentumsangaben.selectAll("text").style("font-weight", "400").style("opacity", .6)

                                              eigentumsangabendetail.transition().duration(800).attr("transform", "scale(0,1)").style("opacity", 1)
                                              markierungendetail.transition().duration(800).attr("transform", "scale(0,1)").style("opacity", 1)
                                              marginaliendetail.transition().duration(800).attr("transform", "scale(1,1)").style("opacity", 1)


                                            }
                                            else {
                                              filter = null
                                              marginalienEntfaltet = false

                                              farbeinfaltungMarginalien()
                                              filterInteraction()
                                              marginalien.selectAll(".MarginalienPlus").text(" ⊕")
                                              zusatzMaterial.selectAll("text").style("font-weight", "400").style("opacity", 1)
                                              anderes.selectAll("text").style("font-weight", "400").style("opacity", 1)
                                              marginalien.selectAll("text").style("font-weight", "400").style("opacity", 1)
                                              markierungen.selectAll("text").style("font-weight", "400").style("opacity", 1)
                                              eigentumsangaben.selectAll("text").style("font-weight", "400").style("opacity", 1)
                                              marginaliendetail.transition().duration(800).attr("transform", "scale(0,1)").style("opacity", 0)
                                              }
                                          })


                                      marginalien.select("text").append("tspan")
                                          .attr("class", "MarginalienPlus")
                                          .text(" ⊕")
                                          .style("font-size", 17 + "px")
                                          // .on("click", function() {
                                          //   if (marginalienEntfaltet == false){
                                          //     marginalienEntfaltet = true
                                          //
                                          //     farbausfaltungMarginalien()
                                          //     marginalien.selectAll(".MarginalienPlus").text(" ⊖")
                                          //     marginalien.selectAll("text").style("font-weight", "bolder")
                                          //     marginaliendetail.transition().duration(800).attr("transform", "scale(1,1)").style("opacity", 1)
                                          //   }
                                          //   else {
                                          //     marginalienEntfaltet = false
                                          //
                                          //     farbeinfaltungMarginalien()
                                          //     marginalien.selectAll(".MarginalienPlus").text(" ⊕")
                                          //     marginalien.selectAll("text").style("font-weight", "500")
                                          //     marginaliendetail.transition().duration(800).attr("transform", "scale(0,1)").style("opacity", 0)
                                          //     }
                                          // })

                      var marginaliendetail = marginalien.append("g").attr("class", "detail").attr("transform", "scale(0,1)").style("opacity", 0)

                      marginaliendetail.append("text")
                          .text("Bewertung")
                          .attr("y", 28)
                          .attr("x", 0)
                          .attr("class", "bewertung")
                          .on("click", function(){
                            if(filter != "bewertung"){
                              filter = "bewertung"
                              filterInteraction()
                            }else{
                              filter = null
                              filterInteraction()
                            }
                          })

                      marginaliendetail.append("text")
                          .text("Kommentar")
                          .attr("y", 28)
                          .attr("x", 90)
                          .attr("class", "kommentar")
                          .on("click", function(){
                            if(filter != "kommentar"){
                              filter = "kommentar"
                              filterInteraction()
                            }else{
                              filter = null
                              filterInteraction()
                            }
                          })

                      marginaliendetail.append("text")
                          .text("Textkorrektur")
                          .attr("y", 28)
                          .attr("x", 190)
                          .attr("class", "textkorrektur")
                          .on("click", function(){
                            if(filter != "textkorrektur"){
                              filter = "textkorrektur"
                              filterInteraction()
                            }else{
                              filter = null
                              filterInteraction()
                            }
                          })

                      marginaliendetail.append("text")
                          .text("Variante")
                          .attr("y", 28)
                          .attr("x", 310)
                          .attr("class", "variante")
                          .on("click", function(){
                            if(filter != "variante"){
                              filter = "variante"
                              filterInteraction()
                            }else{
                              filter = null
                              filterInteraction()
                            }
                          })

                      marginaliendetail.append("text")
                          .text("Übersetzung")
                          .attr("y", 28)
                          .attr("x", 390)
                          .attr("class", "uebersetzung")
                          .on("click", function(){
                            if(filter != "uebersetzung"){
                              filter = "uebersetzung"
                              filterInteraction()
                            }else{
                              filter = null
                              filterInteraction()
                            }
                          })

                          ////////////////Marginalien-Filter Ende
                          ///////////////////////////////////////////////

                      zusatzMaterial.append("text")
                          .text("Zusätzliches Material")
                          .attr("y", 14)
                        //  .attr("x", 600)
                          .on("click", function(){
                            if(filter != "zusatzMaterial"){
                              filter = "zusatzMaterial"
                              filterInteraction()
                              eigentumsangaben.selectAll(".EigentumsangabenPlus").text(" ⊕")
                              markierungen.selectAll(".MarkierungenPlus").text(" ⊕")
                              marginalien.selectAll(".MarginalienPlus").text(" ⊕")
                              zusatzMaterial.selectAll("text").style("font-weight", "bolder").style("opacity", 1)
                              marginalien.selectAll("text").style("font-weight", "400").style("opacity", .6)
                              markierungen.selectAll("text").style("font-weight", "400").style("opacity", .6)
                              eigentumsangaben.selectAll("text").style("font-weight", "400").style("opacity", .6)
                              anderes.selectAll("text").style("font-weight", "400").style("opacity", .6)


                              eigentumsangabendetail.transition().duration(800).attr("transform", "scale(0,1)").style("opacity", 1)
                              markierungendetail.transition().duration(800).attr("transform", "scale(0,1)").style("opacity", 1)
                              marginaliendetail.transition().duration(800).attr("transform", "scale(0,1)").style("opacity", 1)
                            }else{
                              filter = null
                              filterInteraction()
                              anderes.selectAll("text").style("font-weight", "400").style("opacity", 1)
                              zusatzMaterial.selectAll("text").style("font-weight", "400").style("opacity", 1)
                              marginalien.selectAll("text").style("font-weight", "400").style("opacity", 1)
                              markierungen.selectAll("text").style("font-weight", "400").style("opacity", 1)
                              eigentumsangaben.selectAll("text").style("font-weight", "400").style("opacity", 1)
                            }
                          })



                          anderes.append("text")
                              .text("Anderes")
                              .attr("y", 14)
                            //  .attr("x", 600)
                              .on("click", function(){
                                if(filter != "anderes"){
                                  filter = "anderes"
                                  filterInteraction()
                                  eigentumsangaben.selectAll(".EigentumsangabenPlus").text(" ⊕")
                                  markierungen.selectAll(".MarkierungenPlus").text(" ⊕")
                                  marginalien.selectAll(".MarginalienPlus").text(" ⊕")
                                  anderes.selectAll("text").style("font-weight", "bolder").style("opacity", 1)
                                  zusatzMaterial.selectAll("text").style("font-weight", "400").style("opacity", .6)
                                  marginalien.selectAll("text").style("font-weight", "400").style("opacity", .6)
                                  markierungen.selectAll("text").style("font-weight", "400").style("opacity", .6)
                                  eigentumsangaben.selectAll("text").style("font-weight", "400").style("opacity", .6)

                                  eigentumsangabendetail.transition().duration(800).attr("transform", "scale(0,1)").style("opacity", 1)
                                  markierungendetail.transition().duration(800).attr("transform", "scale(0,1)").style("opacity", 1)
                                  marginaliendetail.transition().duration(800).attr("transform", "scale(0,1)").style("opacity", 1)
                                }else{
                                  filter = null
                                  filterInteraction()
                                  anderes.selectAll("text").style("font-weight", "400").style("opacity", 1)
                                  zusatzMaterial.selectAll("text").style("font-weight", "400").style("opacity", 1)
                                  marginalien.selectAll("text").style("font-weight", "400").style("opacity", 1)
                                  markierungen.selectAll("text").style("font-weight", "400").style("opacity", 1)
                                  eigentumsangaben.selectAll("text").style("font-weight", "400").style("opacity", 1)
                                }
                              })




                      ////////////////////////////////////////////////////////////
                      ////////////////////////////////////////////////////////////
                      //////////////////////////////////////////////////////////////





                          function farbausfaltungProvenienz() {
                              transitions = true

                              setTimeout(function() {
                                  transitions = false
                              }, 1000);

                              d3.selectAll(".pieG").selectAll(".provenienz,.provenienzstempel,.sonstigeMarkierung,.anstreichung,.unterstreichung,.durchstreichung,.bewertung,.kommentar,.textkorrektur,.uebersetzung,.variante").classed("eingefaltet", false)


                      }

                      function farbeinfaltungProvenienz() {
                      transitions = true

                      setTimeout(function() {
                      transitions = false
                      }, 1000);

                      d3.selectAll(".pieG").selectAll(".provenienz,.provenienzstempel").classed("eingefaltet", true)


                      }



                          function farbausfaltungMarkierung() {
                              transitions = true

                              setTimeout(function() {
                                  transitions = false
                              }, 1000);

                              d3.selectAll(".pieG").selectAll(".provenienz,.provenienzstempel,.sonstigeMarkierung,.anstreichung,.unterstreichung,.durchstreichung,.bewertung,.kommentar,.textkorrektur,.uebersetzung,.variante").classed("eingefaltet", false)


                          }

                          function farbeinfaltungMarkierung() {
                              transitions = true

                              setTimeout(function() {
                                  transitions = false
                              }, 1000);

                              d3.selectAll(".pieG").selectAll(".unterstreichung,.anstreichung,.durchstreichung,.sonstigeMarkierung").classed("eingefaltet", true)


                          }



                          function farbausfaltungMarginalien() {
                              transitions = true

                              setTimeout(function() {
                                  transitions = false
                              }, 1000);

                              d3.selectAll(".pieG").selectAll(".provenienz,.provenienzstempel,.sonstigeMarkierung,.anstreichung,.unterstreichung,.durchstreichung,.bewertung,.kommentar,.textkorrektur,.uebersetzung,.variante").classed("eingefaltet", false)


                          }

                          function farbeinfaltungMarginalien() {
                              transitions = true

                              setTimeout(function() {
                                  transitions = false
                              }, 1000);

                              d3.selectAll(".pieG").selectAll(".bewertung,.kommentar,.textkorrektur,.uebersetzung,.variante").classed("eingefaltet", true)


                          }





                  ////////////////////////////////////////////////////////////
                  ////////////////////////////////////////////////////////////
                  //////////////////////////////////////////////////////////////



                  ////////// Filter Interaction///////////
                  ///////////////////////////////////////
                  ///////////////////////////////////////



                  function filterInteraction() {
                      transitions = true
                      setTimeout(function() {
                          transitions = false
                      }, 1000);
                      if (filter == null) {
                        d3.selectAll(".pieG").selectAll("path").classed("filtered", false).classed("eingefaltet", true)



                      }else if (filter == "Fontane") {

                          d3.selectAll(".pieG").selectAll("path").classed("filtered", true).filter(".schreibhandFontane").classed("filtered", false)


                      }  else if (filter == "Familie") {

                            d3.selectAll(".pieG").selectAll("path").classed("filtered", true).filter(".schreibhandFamilie").classed("filtered", false)


                        }
                      else if (filter == "eigentumsangaben") {

                          d3.selectAll(".pieG").selectAll("path").classed("filtered", true).filter(".provenienz,.provenienzstempel").classed("filtered", false)


                      }
                      else if (filter == "provenienz") {

                          d3.selectAll(".pieG").selectAll("path").classed("filtered", true).filter(".provenienz").classed("filtered", false)



                      } else if (filter == "provenienzstempel") {

                          d3.selectAll(".pieG").selectAll("path").classed("filtered", true).filter(".provenienzstempel").classed("filtered", false)


                            } else if (filter == "markierungen") {

                              d3.selectAll(".pieG").selectAll("path").classed("filtered", true).filter(".unterstreichung,.anstreichung,.durchstreichung,.sonstigeMarkierung").classed("filtered", false)



                            } else if (filter == "anstreichung") {

                              d3.selectAll(".pieG").selectAll("path").classed("filtered", true).filter(".anstreichung").classed("filtered", false)



                      } else if (filter == "unterstreichung") {

                        d3.selectAll(".pieG").selectAll("path").classed("filtered", true).filter(".unterstreichung").classed("filtered", false)


                      } else if (filter == "durchstreichung") {

                        d3.selectAll(".pieG").selectAll("path").classed("filtered", true).filter(".durchstreichung").classed("filtered", false)


                      } else if (filter == "sonstigeMarkierung") {

      d3.selectAll(".pieG").selectAll("path").classed("filtered", true).filter(".sonstigeMarkierung").classed("filtered", false)


                      } else if (filter == "zusatzMaterial") {
                        d3.selectAll(".pieG").selectAll("path").classed("filtered", true).filter(".zusatzMaterial").classed("filtered", false)


                            } else if (filter == "marginalien") {
                              d3.selectAll(".pieG").selectAll("path").classed("filtered", true).filter(".bewertung,.kommentar,.textkorrektur,.uebersetzung,.variante").classed("filtered", false)



                      } else if (filter == "bewertung") {
                        d3.selectAll(".pieG").selectAll("path").classed("filtered", true).filter(".bewertung").classed("filtered", false)


                      } else if (filter == "kommentar") {
                        d3.selectAll(".pieG").selectAll("path").classed("filtered", true).filter(".kommentar").classed("filtered", false)


                      } else if (filter == "textkorrektur") {
                        d3.selectAll(".pieG").selectAll("path").classed("filtered", true).filter(".textkorrektur").classed("filtered", false)


                      } else if (filter == "variante") {
                        d3.selectAll(".pieG").selectAll("path").classed("filtered", true).filter(".variante").classed("filtered", false)


                      } else if (filter == "uebersetzung") {
                        d3.selectAll(".pieG").selectAll("path").classed("filtered", true).filter(".uebersetzung").classed("filtered", false)



                      } else if (filter == "anderes") {
                        d3.selectAll(".pieG").selectAll("path").classed("filtered", true).filter(".anderes").classed("filtered", false)


                      }


                  }



                  ////////// Filter Interaction Ende/////
                  ///////////////////////////////////////
                  ///////////////////////////////////////




    var width = 2000//1300,
    var height = 1000//680;

    var pieData = []

    complicationData.forEach(function(D,I){
      D.pieDataSum =   +D.Bewertung + +D.Kommentar + +D.Textkorrektur + +D.Variante + +D.Uebersetzung + +D.Anstreichung + +D.Unterstreichung + +D.Durchstreichung + +D.SonstigeMarkierung + +D.ZusatzMaterial + +D.Anderes + +D.Provenienz + +D.Stempel

      D.pieData = []
      D.pieData  = [
        +D.Bewertung,
        +D.Kommentar,
        +D.Textkorrektur,
        +D.Variante,
        +D.Uebersetzung,
        +D.Anstreichung,
        +D.Unterstreichung,
        +D.Durchstreichung,
        +D.SonstigeMarkierung,
        +D.ZusatzMaterial,
        +D.Anderes,
        +D.Provenienz,
        +D.Stempel
      ]

      if(D.level == "buch"){
        D.verfasserX = complicationData.filter(function(Y,Z){return Y.ID == D.Verfasser})[0].x
        D.verfasserY = complicationData.filter(function(Y,Z){return Y.ID == D.Verfasser})[0].y
      }

      })


    d3.select("#complicationsvg").attr("width", width).attr("height", height)



    var scatterZoomScale = d3.scaleLinear()
        .domain([500, 3500])
        .range([1, 2])
        .clamp(true)


    var complicationVis = d3.select("#complicationsvg").append("g").attr("class", "complicationVisG")
    .attr("transform", function(d, i) {return "translate("+-0+","+-0+")scale("+scatterZoomScale(scrollTop)+","+scatterZoomScale(scrollTop)+")"})



    var scatterScaleX = d3.scaleLinear()
        .domain([-20, 20])
        .range([0, 1200])
        .clamp(true)

        var scatterScaleY = d3.scaleLinear()
            .domain([10, -30])
            .range([0, 1200])
            .clamp(true)


            var compOpacityScale = d3.scaleLinear()
                .domain([500, 1500])
                .range([0, 1])
                .clamp(true)

                var verfasserPiesSizeScale = d3.scaleLinear()
                    .domain([500, 1500])
                    .range([0, 1])
                    .clamp(true)

                var pieLineStrokes = d3.scaleLinear()
                    .domain([0, 2500])
                    .range([1, 0])
                    .clamp(true)


        /////////node-pie starting
        var arc = d3.arc();

        var pie = d3.pie()
            .sort(null)
            .value(function(e) { return e; });


            var pieGroup = complicationVis.selectAll(".pieG")
            .data(complicationData)
            .join("g")
            .attr("class", "pieG")
            .attr("transform", function(d,i){return "translate("+scatterScaleX(d.x)+","+scatterScaleY(d.y)+")"})
            .each(multiple)
            .style("opacity", function(d,i){return 1-compOpacityScale(scrollTop)})
            .filter(function(d,i){return d.level == "buch"})
            .style("opacity", function(d,i){return compOpacityScale(scrollTop)})
            .attr("transform", function(d,i){
              var posXalsBuch = d.x
              var posXalsVerfasser = complicationData.filter(function(Y,Z){return Y.ID == d.Verfasser})[0].x
              var posYalsBuch = d.y
              var posYalsVerfasser = complicationData.filter(function(Y,Z){return Y.ID == d.Verfasser})[0].y

              var scatterScaleBuchX = d3.scaleLinear()
                  .domain([-20, 20])
                  .range([0, 1200])
                  .clamp(true)

                  var scatterScaleBuchY = d3.scaleLinear()
                      .domain([10, -30])
                      .range([0, 1200])
                      .clamp(true)

                var scatterScaleBuchVerfasserX = d3.scaleLinear()
                    .domain([500, 3500])
                    .range([posXalsVerfasser, posXalsBuch])
                    .clamp(true)

                var scatterScaleBuchVerfasserY = d3.scaleLinear()
                        .domain([500, 3500])
                        .range([posYalsVerfasser, posYalsBuch])
                        .clamp(true)



              return "translate("+scatterScaleBuchX(scatterScaleBuchVerfasserX(scrollTop))+","+scatterScaleBuchY(scatterScaleBuchVerfasserY(scrollTop))+")"})
          //  .attr("fill", function(d,i){console.log(complicationData.filter(function(Y,Z){return Y.ID == d.Verfasser})[0].x)  })

            function multiple(d) {
              var radius = d3.scaleSqrt()
                  .domain([5, 500])
                  .range([8, 15])
                  .clamp(true)



                   d3.select(this).selectAll(".pieArc")
                       .data(pie(d.pieData))
                       .enter().append("g")
                         .attr("class", "pieArc")
                         .append("path")
                         .attr("d", function(e, c) { if(d.level == "buch"){return arc.outerRadius(radius(d.pieDataSum)).innerRadius(radius(d.pieDataSum)*0.6)(e, c)}
                        else {return arc.outerRadius(radius(d.pieDataSum)).innerRadius(radius(d.pieDataSum)*0)(e, c)}})
                         .attr("class", function(d,i){
                           if(i==0){return "pieArc bewertung"}else if(i==1){return "pieArc kommentar"}else if(i==2){return "pieArc textkorrektur"}else if(i==3){return "pieArc variante"}else if(i==4){return "pieArc uebersetzung"}
                           else if(i==5){return "pieArc anstreichung"}else if(i == 6){return "pieArc unterstreichung"}else if(i == 7){return "pieArc durchstreichung"}  else if(i==8){return "pieArc sonstigeMarkierung"}
                           else if(i==9){return "pieArc zusatzMaterial"}
                           else if(i==10){return "pieArc anderes"}
                           else if(i==11){return "pieArc provenienz"}else if(i==12){return "pieArc provenienzstempel"}
                           })
                          .classed("eingefaltet", true)

              }


          //    console.log(complicationData)


              var scatterScaleX = d3.scaleLinear()
                  .domain([-20, 20])
                  .range([0, 1200])
                  .clamp(true)

                  var scatterScaleY = d3.scaleLinear()
                      .domain([10, -30])
                      .range([0, 1200])
                      .clamp(true)





              var pieMovementLines = complicationVis.selectAll(".pieMovementLines")
              .data(complicationData.filter(function(d){return d.level != "verfasser"}))
              .join("g")
              .attr("class", function(d){return "pieMovementLines"})
            //  .classed("fill", function(d){console.log(d.Verfasser)})
              .append("line")
              .attr("x1", function(d){
                return scatterScaleX(d.verfasserX)})
              .attr("x2", function(d){
                var scatterScaleBuchVerfasserX = d3.scaleLinear()
                        .domain([500, 3500])
                        .range([d.verfasserX, d.x])
                        .clamp(true)

                return scatterScaleX(scatterScaleBuchVerfasserX(scrollTop))
              })
              .attr("y1", function(d){return scatterScaleY(d.verfasserY)})
              .attr("y2", function(d){
                var scatterScaleBuchVerfasserY = d3.scaleLinear()
                        .domain([500, 3500])
                        .range([d.verfasserY, d.y])
                        .clamp(true)

                return scatterScaleY(scatterScaleBuchVerfasserY(scrollTop))
              })
              .style("stroke", "white")
              .style("stroke-width", function(){return pieLineStrokes(scrollTop)})


d3.selectAll(".pieG")
.on("mousemove", function(d){pieHover(d.ID, d)})
.on("mouseout", function(d){pieMouseOut(d.ID, d)})

d3.selection.prototype.moveToFront = function() {
  return this.each(function() {
    this.parentNode.appendChild(this);
  });
};


function pieMouseOut(id,d){

  d3.selectAll(".pieMovementLines").selectAll("line").style("stroke-width", function(){return pieLineStrokes(scrollTop)})


pietooltip.style("display", "none")

if(scrollTop > 1500){
d3.selectAll(".pieG").filter(function(D){return D.Verfasser !== d.Verfasser  && D.level === d.level}).style("opacity", "1")
}

}


function pieHover(id,d){






if(scrollTop > 1500){

  d3.selectAll(".pieMovementLines").filter(function(D){return D.Verfasser !== d.Verfasser}).selectAll("line").style("stroke-width", 0)

d3.selectAll(".pieMovementLines").filter(function(D){return D.Verfasser === d.Verfasser}).selectAll("line").style("stroke-width", 1)

d3.selectAll(".pieG").filter(function(D){return D.Verfasser !== d.Verfasser  && D.level === d.level}).style("opacity", ".05")

d3.selectAll(".pieG").filter(function(D){return D.Verfasser === d.Verfasser  && D.level === d.level})
.moveToFront();
}

pietooltip
.style("display", "inline")

.style('top', d3.event.pageY  -30 + 'px')
.style('left', d3.event.pageX + 10+ 'px')


d3.selectAll(".coverimagesSolo").remove()
d3.selectAll(".coverimagesMulti").remove()

pietooltip.selectAll(".tooltipImage").selectAll(".coverimages")
.data(function(){
  if(d.level != "verfasser"){
    return korpus.filter(function(D, I){return D.KurzSignatur == id })
}else{
    return korpus.filter(function(D, I){return D.Verfasser == id })
}})
.enter()
.append("img")
.attr("src", function(D,I){return "./img/m/" + D.ID + ".jpg"})
.attr("class", function(){if (d.level != "verfasser"){return "coverimagesSolo"}else{return "coverimagesMulti"}})

pietooltip.selectAll(".tooltipTitle").text(function(D){if(d.level != "verfasser"){return korpus.filter(function(E, G) {
      return E.KurzSignatur == id
    })[0].Kurztitel}
  else{return id}})

  pietooltip.selectAll(".tt-verfasser")
  .text(function(D){if(d.level != "verfasser"){return korpus.filter(function(E, G) {
        return E.KurzSignatur == id
      })[0].Verfasser}
    else{return 0}})

    pietooltip.selectAll(".tt-herausgeber")
    .text(function(D){if(d.level != "verfasser"){return korpus.filter(function(E, G) {
          return E.KurzSignatur == id
        })[0].Herausgeber}
      else{return 0}})

      pietooltip.selectAll(".tt-verlag")
      .text(function(D){if(d.level != "verfasser"){return korpus.filter(function(E, G) {
            return E.KurzSignatur == id
          })[0].Verlag}
        else{return 0}})

        pietooltip.selectAll(".tt-genre")
        .text(function(D){if(d.level != "verfasser"){return korpus.filter(function(E, G) {
              return E.KurzSignatur == id
            })[0].Formalschlagwort_Genre}
          else{return 0}})

          pietooltip.selectAll(".tt-datierung")
          .text(function(D){if(d.level != "verfasser"){return korpus.filter(function(E, G) {
                return E.KurzSignatur == id
              })[0].Jahr}
            else{return 0}})


            pietooltip.selectAll(".tt-ort")
            .text(function(D){if(d.level != "verfasser"){return korpus.filter(function(E, G) {
                  return E.KurzSignatur == id
                })[0].Ort}
              else{return 0}})

}



              ///////Ende Pies


              function compScrollFunction() {

d3.selectAll(".pieMovementLines").selectAll("line")
.style("stroke-width", function(){return pieLineStrokes(scrollTop)})
.attr("x1", function(d){
  return scatterScaleX(d.verfasserX)})
.attr("x2", function(d){
  var scatterScaleBuchVerfasserX = d3.scaleLinear()
          .domain([500, 3500])
          .range([d.verfasserX, d.x])
          .clamp(true)

  return scatterScaleX(scatterScaleBuchVerfasserX(scrollTop))
})
.attr("y1", function(d){return scatterScaleY(d.verfasserY)})
.attr("y2", function(d){
  var scatterScaleBuchVerfasserY = d3.scaleLinear()
          .domain([500, 3500])
          .range([d.verfasserY, d.y])
          .clamp(true)

  return scatterScaleY(scatterScaleBuchVerfasserY(scrollTop))
})

                //console.log(scrollTop)
                if (scrollTop > 1500){
                  d3.selectAll(".pieG").filter(function(d,i){return d.level == "verfasser"}).style("display", "none")
                }else{
                    d3.selectAll(".pieG").filter(function(d,i){return d.level == "verfasser"}).style("display", "inline")
                }


d3.selectAll(".pieG").filter(function(d,i){return d.level == "verfasser"}).style("opacity", function(d,i){return 1-compOpacityScale(scrollTop)})

d3.selectAll(".pieG").filter(function(d,i){return d.level == "buch"})
.style("opacity", function(d,i){return compOpacityScale(scrollTop)})
.attr("transform", function(d,i){
  var posXalsBuch = d.x
  var posXalsVerfasser = complicationData.filter(function(Y,Z){return Y.ID == d.Verfasser})[0].x
  var posYalsBuch = d.y
  var posYalsVerfasser = complicationData.filter(function(Y,Z){return Y.ID == d.Verfasser})[0].y

  var scatterScaleBuchX = d3.scaleLinear()
      .domain([-20, 20])
      .range([0, 1200])
      .clamp(true)

      var scatterScaleBuchY = d3.scaleLinear()
          .domain([10, -30])
          .range([0, 1200])
          .clamp(true)

    var scatterScaleBuchVerfasserX = d3.scaleLinear()
        .domain([500, 3500])
        .range([posXalsVerfasser, posXalsBuch])
        .clamp(true)

    var scatterScaleBuchVerfasserY = d3.scaleLinear()
            .domain([500, 3500])
            .range([posYalsVerfasser, posYalsBuch])
            .clamp(true)

    var radiusSizing = d3.scaleLinear()
                .domain([500, 3500])
                .range([0, 1])
                .clamp(true)



  return "translate("+scatterScaleBuchX(scatterScaleBuchVerfasserX(scrollTop))+","+scatterScaleBuchY(scatterScaleBuchVerfasserY(scrollTop))+")scale(+"+radiusSizing(scrollTop)+","+radiusSizing(scrollTop)+")"})

  var scatterZoomScale = d3.scaleLinear()
      .domain([500, 3500])
      .range([2, 1])
      .clamp(true)

      var scatterZoomPositionY = d3.scaleLinear()
          .domain([500, 3500])
          .range([-300,0])
          .clamp(true)

          var scatterZoomPositionX = d3.scaleLinear()
              .domain([500, 3500])
              .range([-600,0])
              .clamp(true)


d3.select(".complicationVisG")
  .attr("transform", function(d, i) {return "translate("+scatterZoomPositionX(scrollTop)+","+scatterZoomPositionY(scrollTop)+")scale("+scatterZoomScale(scrollTop)+","+scatterZoomScale(scrollTop)+")"})



              }



})

    </script>

</body>

</html>
